# Wetrace Skill - 微信聊天记录分析助手

<div align="center">

![Wetrace](https://img.shields.io/badge/Wetrace-微信分析-brightgreen)
![Claude](https://img.shields.io/badge/Claude-AI%20Skill-blue)
![License](https://img.shields.io/badge/license-MIT-green)

**为 Claude Code 提供强大的微信聊天记录分析能力**

[功能特性](#-功能特性) • [快速开始](#-快速开始) • [使用示例](#-使用示例) • [可视化功能](#-可视化功能) • [文档](#-文档)

</div>

---

## 📖 简介

Wetrace Skill 是一个专为 Claude Code 设计的技能包，让 AI 助手能够查询、分析和可视化微信聊天记录。通过自然语言交互，轻松完成复杂的数据分析任务，并生成精美的可视化报告。

> **⚠️ 重要提示**
> - 本 Skill 依赖 [Wetrace](https://github.com/afumu/wetrace) 服务
> - **仅支持 Windows 平台**（微信数据库位于 Windows 系统）
> - 需要先安装并运行 Wetrace 服务才能使用本 Skill

### 核心能力

- 🔍 **智能查询**：通过自然语言查询聊天记录、联系人、群组
- 📊 **数据分析**：分析聊天模式、活跃度趋势、关系动态
- 🎨 **可视化报告**：生成 8 种精美的 HTML 可视化页面
- 💾 **多格式导出**：支持 HTML、PDF、DOCX、CSV、XLSX 等格式
- 🤖 **AI 洞察**：提供智能总结、待办提取、情感分析等功能
- 📈 **客户管理**：CRM 健康度分析、跟进提醒

---

## ✨ 功能特性

### 基础功能

| 功能 | 描述 | 触发词示例 |
|------|------|-----------|
| 📝 查询消息 | 查看与特定联系人的聊天记录 | "查看我和张三的聊天" |
| 🔎 搜索消息 | 通过关键词搜索跨会话消息 | "搜索包含'项目'的消息" |
| 📊 数据统计 | 分析聊天频率、活跃时段 | "统计最活跃的时间段" |
| 💾 导出数据 | 导出多种格式的聊天记录 | "导出聊天记录为 PDF" |
| 💡 智能洞察 | 综合分析并提供建议 | "总结我的社交情况" |

### 可视化功能（8 种）

| 功能 | 描述 | 触发词 |
|------|------|--------|
| 🤖 智能摘要 | AI 总结聊天记录 | "总结聊天记录" |
| ✅ 待办提取 | 自动提取任务清单 | "提取待办事项" |
| 🔥 活跃度热力图 | 24×7 时间分布热力图 | "生成活跃度热力图" |
| 📈 趋势分析 | 多层级时间趋势图 | "分析互动趋势" |
| 📋 周报月报 | 自动生成周报/月报 | "生成本周周报" |
| 📊 数据仪表板 | 综合数据可视化面板 | "生成数据仪表板" |
| 💬 对话摘要 | 智能分类对话内容 | "生成对话摘要" |
| 💼 客户健康度 | CRM 关系健康度分析 | "分析客户健康度" |

---

## 🚀 快速开始

### 系统要求

- **操作系统**：Windows 10/11（必需）
- **原因**：微信数据库仅存在于 Windows 系统中

### 前置要求

1. **Wetrace 服务**：必须先安装并运行 [Wetrace](https://github.com/afumu/wetrace)
   ```bash
   # 下载并运行 Wetrace
   # 详细安装步骤请参考 Wetrace 项目文档
   ```
2. **Claude Code CLI**：已安装 Claude Code（Windows 版本）
3. **微信数据库**：已解密的微信数据库
4. **Wetrace 服务运行**：确保 Wetrace 服务在 `http://127.0.0.1:5200` 运行

### 安装步骤
#### 从源码安装

```bash
# 克隆仓库
git clone https://github.com/afumu/wetrace-skill.git

把wetrace-skill 复制到 .claude/skills 目录下
```

### 验证安装

在 Claude Code 中输入：

```
查看我的微信联系人
```

如果 skill 正常工作，Claude 会开始查询你的微信数据。

---

## 💡 使用示例

### 示例 1：查询聊天记录

**用户输入：**
```
查看我和张三最近一个月的聊天
```

**Claude 响应：**
```
正在获取数据...
✓ 已获取 156 条消息
✓ 时间范围：2024-01-01 至 2024-01-31

## 查询结果：与张三的聊天记录

**消息总数：** 156 条
**活跃天数：** 28 天
**日均消息：** 5.6 条

### 最近消息
1. [2024-01-31 14:23] 张三: 明天见
2. [2024-01-31 10:15] 我: 好的，明天下午2点
...
```

### 示例 2：生成可视化报告

**用户输入：**
```
生成我和张三的聊天活跃度热力图
```

**Claude 响应：**
```
正在分析数据...
✓ 已分析 1,234 条消息
✓ 覆盖 31 天

正在生成热力图...
✓ 24×7 热力图生成完成

---

✅ 热力图已生成！

🌟 最活跃时段：周三 14:00（89 条消息）

💡 洞察：工作日上午和下午是最佳沟通时间

📄 查看完整热力图：
~/wetrace-exports/heatmap_zhangsan_20240131.html
```

### 示例 3：智能待办提取

**用户输入：**
```
提取我和项目组最近的待办事项
```

**Claude 响应：**
```
正在分析聊天记录...
✓ 已分析 256 条消息
✓ 提取到 12 个待办事项

---

✅ 待办事项提取完成！

📊 统计：12 个任务（3 个高优先级，8 个有截止日期）

🔥 高优先级任务预览：
1. 完成项目文档 - ⏰ 2024-01-31
2. 提交季度报告 - ⏰ 2024-01-25
3. 修复线上 Bug - 🚨 紧急

📄 完整清单：~/wetrace-exports/todos_project_20240131.html
```

---

## 🎨 可视化功能

所有生成的 HTML 页面都具有以下特点：

- ✅ **独立运行**：无需服务器，双击即可在浏览器打开
- ✅ **响应式设计**：完美适配桌面、平板、手机
- ✅ **现代化样式**：基于 Tailwind CSS 的精美设计
- ✅ **交互式图表**：使用 Chart.js 实现数据可视化
- ✅ **统一设计系统**：一致的颜色、组件、布局
- ✅ **易于分享**：可直接发送给他人查看

### 1. 智能摘要生成

将聊天记录转换为简洁的智能摘要，包含 AI 总结、关键要点和数据统计。

**触发词：** 总结聊天记录、生成摘要、智能总结

**示例输出：**
- 📊 消息总数、活跃天数、日均消息
- 🤖 AI 智能总结
- 💡 关键要点列表
- 😊 整体情感分析

### 2. 待办事项提取

自动从聊天记录中提取待办事项，生成结构化的任务清单。

**触发词：** 提取待办、找出任务、待办事项

**示例输出：**
- 🔥 高优先级任务
- ⚡ 中优先级任务
- 📌 低优先级任务
- ⏰ 截止日期和负责人
- ✅ 可交互的复选框

### 3. 聊天活跃度热力图

生成 GitHub 风格的 24×7 活跃度热力图，直观展示最佳沟通时间。

**触发词：** 活跃度热力图、聊天时间分布

**示例输出：**
- 🔥 24×7 热力图矩阵
- 🌟 最活跃时段排名
- 📊 活跃度统计
- 💡 AI 沟通建议

### 4. 互动趋势分析

生成可钻取的多层级时间趋势图（月→日→小时）。

**触发词：** 趋势分析、互动趋势

**示例输出：**
- 📈 可切换的趋势图（月度/每日/每小时）
- 📊 峰值、平均值、增长率
- 💡 趋势洞察和建议

### 5. 智能周报月报

自动生成精美的周报或月报，包含数据统计、AI 总结和可视化图表。

**触发词：** 生成周报、生成月报

**示例输出：**
- 🎨 渐变色封面设计
- 📊 核心数据统计
- 🤖 AI 智能总结
- 📈 消息趋势图
- 👥 Top 10 联系人排名
- 💡 关键洞察

### 6. 数据仪表板

生成交互式数据仪表板，集成多个可视化组件。

**触发词：** 生成仪表板、数据总览

**示例输出：**
- 📊 核心指标卡片（消息总数、联系人数、日均消息）
- 🍩 消息类型分布饼图
- 📊 每小时活跃度柱状图
- 🕸️ 星期活跃度雷达图
- 👥 Top 联系人排名
- 💡 快速洞察面板

### 7. 智能对话摘要

使用 AI 对聊天记录进行智能分类和总结，自动提取关键信息。

**触发词：** 对话摘要、智能总结、分类摘要

**示例输出：**
- 💼 工作讨论分类
- 🏠 日常闲聊分类
- ⚡ 重要决策记录
- ✅ 待办事项清单
- 📌 关键信息提取（时间、地址、金额、联系方式）

### 8. 客户关系健康度

生成客户关系健康度仪表板，帮助管理客户关系。

**触发词：** 客户健康度、CRM 仪表板

**示例输出：**
- 💚 健康客户列表
- 💛 需要关注客户
- ❤️ 紧急跟进客户
- 📊 健康度评分算法（0-100）
- 💬 智能跟进建议
- ⏰ 最佳联系时间

---

## 📚 文档

### 核心文档

- **[SKILL.md](SKILL.md)** - Skill 主文档，包含核心工作流程
- **[API 文档](references/api.md)** - Wetrace API 完整参考
- **[设计系统](references/design-system.md)** - HTML 页面设计规范
- **[分析提示](references/analysis-prompts.md)** - AI 分析模板

### 可视化功能文档

- [智能摘要生成](references/01-smart-summary.md)
- [待办事项提取](references/02-todo-extraction.md)
- [活跃度热力图](references/03-activity-heatmap.md)
- [互动趋势分析](references/04-trend-analysis.md)
- [智能周报月报](references/05-weekly-monthly-report.md)
- [数据仪表板](references/06-dashboard.md)
- [智能对话摘要](references/07-conversation-summary.md)
- [客户关系健康度](references/08-customer-health.md)

---

## 🔧 高级配置

### 自定义 API 地址

如果你的 Wetrace 服务运行在非默认地址，可以在使用时指定：

```
使用 http://192.168.1.100:5200 作为 Wetrace 服务地址
```

### 自定义导出目录

默认导出目录为 `~/wetrace-exports/`，可以在使用时指定其他目录：

```
将报告导出到 ~/Documents/wetrace-reports/
```

### 时间范围格式

支持多种时间范围格式：

- **中文**：最近一周、上个月、今年
- **英文**：last week、last month、this year
- **绝对时间**：2024-01-01~2024-01-31
- **相对天数**：last 7 days、last 30 days

---

## 🛠️ 故障排除

### 问题 1：无法连接到 Wetrace 服务

**症状：** Claude 提示"服务器无响应"

**解决方案：**
1. 确认 Wetrace 服务正在运行：`ps aux | grep wetrace`
2. 检查服务地址：`curl http://127.0.0.1:5200/api/v1/health`
3. 如果服务未运行，启动服务：`./wetrace`

### 问题 2：找不到联系人或会话

**症状：** Claude 提示"未找到指定的会话"

**解决方案：**
1. 确认联系人名称拼写正确
2. 尝试使用备注名或昵称
3. 先查询所有会话：`显示所有联系人`

### 问题 3：生成的 HTML 页面无法打开

**症状：** 双击 HTML 文件无反应

**解决方案：**
1. 右键点击文件 → 打开方式 → 选择浏览器
2. 检查文件路径中是否包含特殊字符
3. 确认文件已完整生成（检查文件大小）

### 问题 4：API 返回 404 错误

**症状：** Claude 提示"API 返回 404"

**解决方案：**
1. 确认微信数据库已加载
2. 检查 Wetrace 服务版本是否支持该 API
3. 查看 Wetrace 服务日志

---

## 🤝 贡献指南

欢迎贡献代码、报告问题或提出建议！

### 报告问题

如果你发现了 bug 或有功能建议，请：

1. 在 [GitHub Issues](https://github.com/afumu/wetrace-skill/issues) 创建新 issue
2. 提供详细的问题描述和复现步骤
3. 附上相关的错误信息或截图

### 贡献代码

1. Fork 本仓库
2. 创建你的特性分支：`git checkout -b feature/AmazingFeature`
3. 提交你的更改：`git commit -m 'Add some AmazingFeature'`
4. 推送到分支：`git push origin feature/AmazingFeature`
5. 创建 Pull Request

### 开发指南

- 遵循现有的代码风格和文档格式
- 确保所有文档都是中文
- 测试你的更改
- 更新相关文档

---

## 📄 许可证

本项目采用 MIT 许可证 - 详见 [LICENSE](LICENSE) 文件

---

## 🙏 致谢

- [Claude Code](https://claude.ai/code) - AI 编程助手
- [Wetrace](https://github.com/afumu/wetrace) - 微信数据分析工具
- [Tailwind CSS](https://tailwindcss.com/) - CSS 框架
- [Chart.js](https://www.chartjs.org/) - 图表库
